<Journal><Description>Retrieve laser power for the current illumination.  [Requires] illumination name must end in 3 digits of laser wavelength</Description><Version VersionNumber="2.4"/><CodeBlock><CommentEntry></CommentEntry><CommentEntry>Get the current illumination name.  This will be used to store the laser power</CommentEntry><AssignVariableEntry VariableName="current_illumination_name" Expression="Device.Illumination.Setting"/><CommentEntry></CommentEntry><CommentEntry>Extract wavelength from illumination name.  If the channel does not end in 3 digits, the prompt defaults to the first component name</CommentEntry><AssignVariableEntry VariableName="wavelength_STR" Expression="RIGHT(current_illumination_name,3)"/><AssignVariableEntry VariableName="wavelength" Expression="VAL(wavelength_STR)"/><CommentEntry></CommentEntry><CommentEntry>Read value from INI file</CommentEntry><FunctionEntry GUID="{0xfff247b4-0x87de-0x4382-0x8c-0x28-0x8c-0x8c-0x21-0xa0-0x23-0xdc}" FunctionName="Get INI String" Interactive="0" ApplicationName="mmproc" VersionNumber="1" CommandID="1" MissingImage="0" MetaJournal="091858D0" IsCurrentVersion="1" Variables="09185724"><Variable Type="String" Name="jnlGetIniString.stIniPath" NDimensions="0" Override="None" OverrideVariable="IniPath">49 C:\MM\app\mmproc\journals\illumination_values.ini</Variable><Variable Type="String" Name="jnlGetIniString.stIniSection" NDimensions="0" Override="None" OverrideVariable="IniSection">17 Laser Intensities</Variable><Variable Type="String" Name="jnlGetIniString.stIniKey" NDimensions="0" Override="Variable" OverrideVariable="current_illumination_name">12 Confocal 488</Variable><Variable Type="String" Name="jnlGetIniString.stDefaultValue" NDimensions="0" Override="None" OverrideVariable="DefaultValue">4 None</Variable><Variable Type="String" Name="jnlGetIniString.stVariable" NDimensions="0" Override="None" OverrideVariable="Variable">19 laser_intensity_STR</Variable></FunctionEntry><CommentEntry></CommentEntry><CommentEntry>Set component value</CommentEntry><IfThenElseEntry Disabled="0" Expression="NOT(laser_intensity_STR = &quot;None&quot;)"><CodeBlock Condition="true"><AssignVariableEntry VariableName="laser_intensity" Expression="VAL(laser_intensity_STR)"/><IfThenElseEntry Expression="wavelength = 405"><CodeBlock Condition="true"><AssignVariableEntry VariableName="Component.405_Laser_Intensity.Position" Expression="laser_intensity" Disabled="0"/></CodeBlock><CodeBlock Condition="false"><IfThenElseEntry Expression="wavelength = 445"><CodeBlock Condition="true"><AssignVariableEntry Disabled="0" VariableName="Component.445_Laser_Intensity.Position" Expression="laser_intensity"/></CodeBlock><CodeBlock Condition="false"><IfThenElseEntry Expression="wavelength = 488"><CodeBlock Condition="true"><AssignVariableEntry Disabled="0" VariableName="Component.488_Laser_Intensity.Position" Expression="laser_intensity"/></CodeBlock><CodeBlock Condition="false"><IfThenElseEntry Expression="wavelength = 515"><CodeBlock Condition="true"><AssignVariableEntry Disabled="0" VariableName="Component.515_Laser_Intensity.Position" Expression="laser_intensity"/></CodeBlock><CodeBlock Condition="false"><IfThenElseEntry Expression="wavelength = 561"><CodeBlock Condition="true"><AssignVariableEntry Disabled="0" VariableName="Component.561_Laser_Intensity.Position" Expression="laser_intensity"/></CodeBlock><CodeBlock Condition="false"/></IfThenElseEntry></CodeBlock></IfThenElseEntry></CodeBlock></IfThenElseEntry></CodeBlock></IfThenElseEntry></CodeBlock></IfThenElseEntry></CodeBlock><CodeBlock Condition="false"><CommentEntry>We could not read the laser intesity.  Leave the laser intensity alone</CommentEntry></CodeBlock></IfThenElseEntry></CodeBlock></Journal>
