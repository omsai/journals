Micropoint
==========
Metamorph's bleaches a single point at the center of the target 
Region of Interest (ROI).
To bleach an area larger than a single point over a region, one has
to segment the polygon or line into smaller regions.

1.  `CreateSegmentROIs_deleteROI1.jnl` bleaches straight lines

2.  `CreateROIsForLaserApp.jnl` bleaches irregularly shaped objects


Setup
-----
Enter the administrator and enable the `gridbin` Drop-in.
Make sure the `Legacy` category is checked, located under
the list of Drop-ins.  Then in Metamorph you will then be able to
see the drop-in listed under Display > Graphics > Boxes


Configure segmented ROI size
----------------------------
Edit the journal statement `Boxes on Binary Image` to set Box Width
and Box Height


(Irregular ROI only) Exclude small "boundary" ROIs
---------------------------------------------------
Modify the Integrated Morphometry Analysis (IMA) state file to
exclude objects of a certain size.

When using irregular regions, small segmented regions can be
generated towards the edges of the targeted ROI.  This has the
effect of making the pulse energy more dense, so for even bleaching
you may want to delete these or exclude them from being created
by the IMA state file.<!-- content below automatically generated by doc_jnl.py -->
### Source Code
CreateROIsForLaserApp.JNL:
```python
'''
Create grid image and mask of ROI with the same image size as the original.
'''
# Populate bounding ROI with smaller ROIs to fill in region. Size of smaller ROIs is determined by size of grid boxes define in "Boxes on Binary Image" step. 

# Get mask of bounding ROI
# Create a new binary image to draw the ROI which is the same size as the original. 
NewWidth = Image.Width
NewHeight = Image.Height
New(NewWidth = ,
    NewHeight = ,
    Depth = ,
    Gray Value = ,
    BoundingROI,
    6 9 17 1 -1 -1 3 New ,
    ,
    ,
    ,
    ,
    ,
    )
# Transfer region from original image to mask of bounding ROI. Clear region from original image. 
Transfer_Regions(5 9 0 1 -1 -1 8 Untitled ,
                 6 9 0 1 -1 -1 11 BoundingROI ,
                 ,
                 ,
                 )
Paint_Region(6 9 0 1 -1 -1 11 BoundingROI ,
             ,
             0 5, 1 65535, 2 61 150, 3 0 0, 4 0, 5 1, 6 100 82 172 82 170 82 169 82 167 82 166 81 165 81 164 81 162 81 161 80 160 80 159 79 158 79 157 79 156 78 155 77 154 77 153 76 153 76 152 75 152 74 151 74 151 73 150 72 150 72 150 72 150 71 150 71 150 70 150 69 151 69 151 68 152 67 152 67 153 66 153 66 154 65 155 64 156 64 157 64 158 63 159 63 160 62 161 62 162 62 164 62 165 61 166 61 167 61 169 61 170 61 171 61 172 61 173 61 175 61 176 62 177 62 178 62 180 62 181 63 182 63 183 64 184 64 185 64 186 65 187 66 188 66 189 67 189 67 190 68 190 69 191 69 191 70 192 71 192 71 192 71 192 72 192 72 192 73 192 74 191 74 191 75 190 76 190 76 189 77 189 77 188 78 187 79 186 79 185 79 184 80 183 80 182 81 181 81 180 81 178 81 177 82 176 82 175 82 173 82 172, 7 1,
             ,
             ,
             ,
             ,
             ,
             ,
             ,
             )
Clear_Regions(6 9 0 1 -1 -1 11 BoundingROI )

# Create Grid image with same width and height dimensions as current at start
New(NewWidth = ,
    NewHeight = ,
    Depth = ,
    Gray Value = ,
    NewGrid,
    6 9 17 1 -1 -1 3 New ,
    ,
    ,
    ,
    ,
    ,
    )
# EDIT the next step (#6) to change the size of the grid boxes. 
# Draw grid boxes.  
Boxes_on_Binary_Image(7 9 0 1 5 0 9 GridBoxes ,
                      ,
                      ,
                      ,
                      ,
                      )
# Invert grid so boxes are white and borders are black. 
Morphological_Invert(3 9 0 1 -1 -1 8 Untitled ,
                     6 9 17 1 -1 -1 4 Grid )
Close(7 9 0 1 5 0 8 Untitled ,
      )

# Use the Grid Mask and the Bounding ROI mask to populate bounding ROI with multiple regions. 
Arithmetic(6 9 0 1 -1 -1 11 BoundingROI ,
           6 9 0 1 -1 -1 4 grid ,
           6 9 17 1 -1 -1 9 SmallROIs )
# Use an IMA state file that will exclude small objects that do not define a full grid box at the edge of the object
Integrated_Morphometry_-_Load_State(3 9 0 1 -1 -1 3 AND ,
                                    C:\MMpp\mmproc\journals\micropoint\AreaGreaterThan1.IMA)
FunctionEntry
Create_Regions_Around_Objects(3 9 0 1 -1 -1 8 Untitled )
Resequence_Region_Labels(3 10 0 1 -1 -1 8 Untitled )

# Transfer small ROIs to original image. 
Transfer_Regions(6 9 0 1 -1 -1 9 SmallROIs ,
                 5 9 0 1 -1 -1 11 BoundingROI ,
                 ,
                 ,
                 )

# Close intermediate images. 
Close(6 9 0 1 -1 -1 11 BoundingROI ,
      )
Close(6 9 0 1 -1 -1 4 Grid ,
      )
Close(6 9 0 1 -1 -1 9 SmallROIs ,
      )
```

CreateSegmentROIs_deleteROI1.JNL:
```python
'''
Segment a line region along the center with smaller ROIs. Make sure region
number 1 is the original line.
'''
# Edit next step to change the size of the box along the line
Create_Segment_Regions(5 9 0 1 -1 -1 8 Untitled ,
                       ,
                       ,
                       ,
                       ,
                       ,
                       ,
                       )
# Resequence so original line is always 1.  After creating segment ROI you sometimes get two ROIs with same number, #1.
Resequence_Region_Labels(5 10 0 1 -1 -1 8 Untitled )
# Delete original line region
Select_Region(5 9 0 1 -1 -1 8 Untitled ,
              1)
Delete_Active_Region()
# Resequence segmented ROIs
Resequence_Region_Labels(5 10 0 1 -1 -1 8 Untitled )
```
