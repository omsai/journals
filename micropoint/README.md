Micropoint
==========
Metamorph's bleaches a single point at the center of the target 
Region of Interest (ROI).
To bleach an area larger than a single point over a region, one has
to segment the polygon or line into smaller regions.

1.  `CreateSegmentROIs_deleteROI1.jnl` bleaches straight lines

2.  `CreateROIsForLaserApp.jnl` bleaches irregularly shaped objects


Setup
-----
Enter the administrator and enable the `gridbin` Drop-in.
Make sure the `Legacy` category is checked, located under
the list of Drop-ins.  Then in Metamorph you will then be able to
see the drop-in listed under Display > Graphics > Boxes


Configure segmented ROI size
----------------------------
Edit the journal statement `Boxes on Binary Image` to set Box Width
and Box Height


(Irregular ROI only) Exclude small "boundary" ROIs
---------------------------------------------------
Modify the Integrated Morphometry Analysis (IMA) state file to
exclude objects of a certain size.

When using irregular regions, small segmented regions can be
generated towards the edges of the targeted ROI.  This has the
effect of making the pulse energy more dense, so for even bleaching
you may want to delete these or exclude them from being created
by the IMA state file.<!-- content below automatically generated by doc_jnl.py -->
Source Code
-----------
CreateROIsForLaserApp.JNL:
```python
'''
Create grid image and mask of ROI with the same image size as the original.
'''
# Populate bounding ROI with smaller ROIs to fill in region. Size of smaller ROIs is determined by size of grid boxes define in "Boxes on Binary Image" step. 

# Get mask of bounding ROI
# Create a new binary image to draw the ROI which is the same size as the original. 
NewWidth = Image.Width
NewHeight = Image.Height
New()
# Transfer region from original image to mask of bounding ROI. Clear region from original image. 
Transfer_Regions()
Paint_Region()
Clear_Regions()

# Create Grid image with same width and height dimensions as current at start
New()
# EDIT the next step (#6) to change the size of the grid boxes. 
# Draw grid boxes.  
Boxes_on_Binary_Image()
# Invert grid so boxes are white and borders are black. 
Morphological_Invert()
Close()

# Use the Grid Mask and the Bounding ROI mask to populate bounding ROI with multiple regions. 
Arithmetic()
# Use an IMA state file that will exclude small objects that do not define a full grid box at the edge of the object
Integrated_Morphometry_-_Load_State()
Integrated_Morphometry_-_Measure()
Create_Regions_Around_Objects()
Resequence_Region_Labels()

# Transfer small ROIs to original image. 
Transfer_Regions()

# Close intermediate images. 
Close()
Close()
Close()
```

CreateSegmentROIs_deleteROI1.JNL:
```python
'''
Segment a line region along the center with smaller ROIs. Make sure region
number 1 is the original line.
'''
# Edit next step to change the size of the box along the line
Create_Segment_Regions()
# Resequence so original line is always 1.  After creating segment ROI you sometimes get two ROIs with same number, #1.
Resequence_Region_Labels()
# Delete original line region
Select_Region()
Delete_Active_Region()
# Resequence segmented ROIs
Resequence_Region_Labels()
```
